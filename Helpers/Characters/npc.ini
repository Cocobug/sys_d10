[DEFAULT]
    you=gm

[start]
    description=Macro de début de combat
    self=Initialisation de @{selected|character_name}
    others=
    macro=!setattr --sel --momentum|0 --temp_dmg|0 --temp_pdmg|0 --temp_esq|0 --temp_def|0 --temp_pdef|0 --regen|0 --dot|0 --frostdamage|0 --frostshield|0 --mana|@{selected|mana|max} --pctreceived_b|0 --pctreceived_s|0 --elem_omega|0 --pcthealing|100 --shieldregen|0 --grieviouswounds|1

[turn]
    description=Macro de tour
    self=Tour de @{selected|character_name}
    others=
    macro=!setattr --sel --Life_Points|[[{@{selected|Life_Points}+floor(@{selected|regen}*@{selected|pcthealing}/100)-1*(@{selected|dot}),@{selected|Life_Points|max}}kl1]] --shield|[[{@{selected|shield}+@{selected|shieldregen},@{selected|shield|max}}]]

[attaque_macro]
    description=Macro d'attaque
    self=
    others=
    macro=!crit ?{Nombre de des d'attaque|0} P @{selected|general_effective_Perfection} c @{selected|crit_level} M @{selected|skillcost_Technique_martiale} @{selected|general_effective_Technique_martiale} E @{selected|skillcost_Exploiter_les_points_faibles} @{selected|general_effective_Exploiter_les_points_faibles} F @{selected|general_effective_Fauchage} D @{selected|general_effective_Coup_dechirant} H @{selected|base_damage_dices} H @{selected|exal_damage_dices} A @{selected|Skill_general_attribute_select_attaque} s @{selected|general_attack_threshold} l @{selected|general_attack_addall} a a n @{selected|undescored_name} + @{selected|additional_damage_dices} + @{selected|general_effective_weapon1} + @{selected|general_effective_weapon2} t @{selected|transcendence} + @{selected|general_effective_weapon3} f @{selected|pctinflicted} f @{selected|pctinflicted_s} f @{selected|pctinflicted_b} + @{selected|temp_dmg} f @{selected|temp_pdmg}
        !setattr --charid @{selected|character_id} --temp_pdmg|0 --temp_dmg|0

[esquive_macro]
    description=Macro d'esquive
    self=
    others=
    macro=!crit ?{Nombre de des d'esquive|0} I @{selected|skillcost_Defense_impenetrable} @{selected|general_effective_Defense_impenetrable} R @{selected|general_effective_Rempart_parfait} c @{selected|crit_level} H @{selected|base_dodge_dices} A @{selected|Skill_general_attribute_select_dodge} t @{selected|transcendence} s ?{selected|Seuil d'esquive|0} - ?{Dégats a esquiver|0} a e n @{selected|undescored_name} v @{selected|pctreceived} v @{selected|pctreceived_s} v @{selected|pctreceived_b} + @{selected|temp_esq}
        !setattr --charid @{selected|character_id} --temp_esq|0

[parade_macro]
    description=Macro de parade
    self=
    others=
    macro=!crit ?{Nombre de des de defense|0} I @{selected|skillcost_Defense_impenetrable} @{selected|general_effective_Defense_impenetrable} R @{selected|general_effective_Rempart_parfait} c @{selected|crit_level} S @{selected|general_skilllevel_Encaissement} @{selected|general_effective_Encaissement} H @{selected|base_defense_dices} H @{selected|exal_defense_dices} s @{selected|general_defense_threshold} l @{selected|general_defense_addall} A @{selected|Skill_general_attribute_select_defense} t @{selected|transcendence} - ?{Dégats a parer|0} a d n @{selected|undescored_name} + @{selected|general_effective_shield1} + @{selected|general_effective_shield2} + @{selected|general_effective_shield3} v @{selected|pctreceived} v @{selected|pctreceived_s} v @{selected|pctreceived_b} v @{selected|temp_pdef} + @{selected|temp_def} + ?{Type d'attaque|Physique,@{selected|general_skilllevel_res_physique_effective}|Magique,@{selected|general_skilllevel_res_magique_effective}|Voile,@{selected|general_skilllevel_res_voile_effective}|Divine,@{selected|general_skilllevel_res_divine_effective}|Existence,0} + @{selected|general_skilllevel_res_omega_effective}
        !setattr --charid @{selected|character_id} --temp_pdef|0 --temp_def|0

[parade_brute_macro]
    description=Macro de parade
    self=
    others=
    macro=!crit ?{Nombre de des de defense} I @{selected|skillcost_Defense_impenetrable} @{selected|general_effective_Defense_impenetrable} R @{selected|general_effective_Rempart_parfait} c @{selected|crit_level} S @{selected|general_skilllevel_Encaissement} @{selected|general_effective_Encaissement} H @{selected|base_defense_dices} H @{selected|exal_defense_dices} s @{selected|general_defense_threshold} l @{selected|general_defense_addall} A @{selected|Skill_general_attribute_select_defense} t @{selected|transcendence} - ?{Dégats a parer|0} a d n @{selected|undescored_name} + @{selected|general_item_shield3} v @{selected|pctreceived} v @{selected|pctreceived_s} v @{selected|pctreceived_b} v @{selected|temp_pdef} + @{selected|temp_def} + ?{Type d'attaque|Physique,@{selected|general_skilllevel_res_physique_effective}|Magique,@{selected|general_skilllevel_res_magique_effective}|Voile,@{selected|general_skilllevel_res_voile_effective}|Divine,@{selected|general_skilllevel_res_divine_effective}|Existence,0} + @{selected|general_skilllevel_res_omega_effective}
        !setattr --charid @{selected|character_id} --temp_pdef|0 --temp_def|0

[tir_macro]
    description=Macro de Tir
    self=
    others=
    macro=!crit ?{Nombre de des de tir|0} T @{selected|skillcost_Tir_precis} @{selected|general_effective_Tir_precis} i @{selected|general_effective_Tir_implacable} M @{selected|skillcost_Technique_martiale} @{selected|general_effective_Technique_martiale} E @{selected|skillcost_Exploiter_les_points_faibles} @{selected|general_effective_Exploiter_les_points_faibles} L @{selected|base_shoot_dices} c @{selected|crit_level} l @{selected|add_shoot_dices} t @{selected|transcendence} s ?{Seuil de tir|6} a a n @{selected|undescored_name} f @{selected|pctinflicted} f @{selected|pctinflicted_s} f @{selected|pctinflicted_b}

[place_aoe]
    description=
    self=
    others=
    macro=!areasOfEffectApplyEffectAtToken @{target|token_id} ?{Specify radius:}

[direction_aoe]
    description=
    self=
    others=
    macro=!areasOfEffectApplyEffectAtCone @{selected|token_id} ?{Specify radius:}

[add-regen]
    description=
    self=
    others=
    macro=!setattr --charid @{target|T1|character_id} --mod --regen|[[?{Dégats }]]

[add-dot]
    description=
    self=
    others=
    macro=!setattr --charid @{target|T1|character_id} --mod --dot|[[?{Dégats }]]
[def_pct.t]
    description=
    self=
    others=
    macro=!setattr --mod --charid @{target|T1|character_id} --temp_pdef|?{&#37; Dégats reduits}
[def_pct]
    description=
    self=
    others=
    macro=!setattr --mod --charid @{target|T1|character_id} --pctreceived|?{&#37; Dégats reduits}
[dmg_pct.t]
    description=
    self=
    others=
    macro=!setattr --mod --charid @{target|T1|character_id} --temp_pdmg|?{&#37; Dégats supplementaire}
[dmg_pct]
    description=
    self=
    others=
    macro=!setattr --mod --charid @{target|T1|character_id} --pctinflicted|?{&#37; Dégats supplementaire}
[cond_list]
    description=
    self=
    others=
    macro=!ct show
[seuil]
    description=
    self=
    others=
    macro=!setattr --sel --

[def.threshold]
    description=
    self=
    others=
    macro=!setattr --charid @{target|T1|character_id} --general_defense_threshold|?{Seuil de defence}

[dmg.threshold]
    description=
    self=
    others=
    macro=!setattr --charid @{target|T1|character_id} --general_attack_threshold|?{Seuil de defence}

[resist]
    description=
    self=
    others=
    macro=&{template:d10skillcheck}{{name=@{selected|character_name}}} {{roll_name=Jet de résistance}} {{result=[[?{Type|Magique, @{selected|general_skilllevel_res_magique}|Physique, @{selected|general_skilllevel_res_physique}|Mentale, @{selected|general_skilllevel_res_mentale}|Voile, @{selected|general_skilllevel_res_voile}|Divine, @{selected|general_skilllevel_res_divine}|Existence, @{selected|general_skilllevel_res_omega}}+(?{Caractèristique|Volonté, @{selected|base-Volonte}+@{selected|exal-Volonte}|Force, @{selected|base-Force}+@{selected|exal-Force}|Spéciale, @{selected|base-custom}+@{selected|exal-custom}})-d?{Des|10}cs1]]}}

[aurore]
    description=
    self=
    others=
    macro=!setattr --sel --mod --temp_def|

[healit]
    description=
    self=
    others=
    macro=!setattr --charid @{target|character_id} --Life_Points|

[heal]
    description=
    self=
    others=
    macro=!setattr --charid @{target|T1|character_id} --Life_Points|[[{@{target|T1|Life_Points|max},@{target|T1|Life_Points}+floor(?{Soins|0}*@{target|T1|pcthealing}/100)}kl1]]
